<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dashboard | RealEstateAI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,450;9..144,650&family=IBM+Plex+Sans:wght@400;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/static/app.css" />
  </head>
  <body data-page="dashboard">
    <header class="topbar">
      <a class="brand" href="/"><span class="brand-mark">RE</span><span class="brand-name">RealEstateAI</span></a>
      <nav class="nav">
        <a href="/app/dashboard">Dashboard</a>
        <a href="/app/leads">Leads</a>
        <a href="/app/integrations">Integrations</a>
        <a href="/app/appointments">Appointments</a>
        <a href="/app/billing">Billing</a>
        <a href="/app/register">Register</a>
        <a class="pill" href="/app/login">Account</a>
      </nav>
    </header>

    <main class="page">
      <section class="page-inner">
        <div class="app-header">
          <h1 class="page-title">Dashboard</h1>
          <div class="row">
            <a class="btn" href="/app/leads">Leads</a>
            <a class="btn" href="/app/integrations">Integrations</a>
            <a class="btn ghost" href="/app/login">Account</a>
          </div>
        </div>

        <div id="dashGrid" class="grid-3">
          <div class="card metric">
            <div class="muted small">Total leads</div>
            <div id="mTotal" class="metric-value">-</div>
          </div>
          <div class="card metric">
            <div class="muted small">Avg lead score</div>
            <div id="mScore" class="metric-value">-</div>
          </div>
          <div class="card metric">
            <div class="muted small">Conversion rate</div>
            <div id="mConv" class="metric-value">-</div>
          </div>
        </div>

        <div class="card">
          <div class="row space">
            <h3>P&L and growth (real-time)</h3>
            <button class="btn" id="refreshChart" type="button">Refresh</button>
          </div>
          <p class="muted small">Estimates update from your live database (leads + subscriptions).</p>
          <div class="chart-wrap">
            <canvas id="kpiChart" width="960" height="280"></canvas>
          </div>
          <div class="grid-3" style="margin-top:12px">
            <div class="card metric" style="box-shadow:none">
              <div class="muted small">MRR</div>
              <div id="mMrr" class="metric-value">-</div>
            </div>
            <div class="card metric" style="box-shadow:none">
              <div class="muted small">Profit</div>
              <div id="mProfit" class="metric-value">-</div>
            </div>
            <div class="card metric" style="box-shadow:none">
              <div class="muted small">Losses</div>
              <div id="mLoss" class="metric-value">-</div>
            </div>
          </div>
          <div id="chartMsg" class="muted small"></div>
        </div>

        <div class="card">
          <h3>Quick actions</h3>
          <p class="muted">Create a lead, connect channels, and generate reports.</p>
          <div class="row">
            <a class="btn primary" href="/app/leads">Open leads</a>
            <a class="btn" href="/app/integrations">Connect channels</a>
          </div>
          <div id="dashMsg" class="muted small"></div>
        </div>

        <div class="card">
          <div class="row space">
            <h3>Deploy Agent (Embeddable)</h3>
            <div class="row">
              <button class="btn" id="copyEmbedSnippet" type="button">Copy snippet</button>
              <button class="btn" id="refreshEmbedKey" type="button">Refresh</button>
            </div>
          </div>
          <p class="muted small">
            Install a lightweight lead capture widget on your website. The dashboard shows the key masked, but the install link and snippet include it.
          </p>
          <div class="grid-2" style="margin-top:12px">
            <div class="card" style="box-shadow:none">
              <div class="muted small">API Public Key (masked)</div>
              <div id="embedKeyMasked" class="metric-value" style="margin-top:6px">-</div>
              <div style="height:10px"></div>
              <div class="muted small">Install link (contains key)</div>
              <a id="embedInstallLink" class="codebox wrap-anywhere" href="#" target="_blank" rel="noopener" style="display:block;margin-top:10px">-</a>
            </div>
            <div class="card" style="box-shadow:none">
              <div class="muted small">JS embed snippet (contains key)</div>
              <pre id="embedSnippet" class="codebox wrap-anywhere" style="margin-top:10px;white-space:pre-wrap"></pre>
              <div class="muted small" style="margin-top:10px">
                Example: <code>&lt;script src="https://YOUR-DOMAIN/embed.js?key=YOUR_KEY" async&gt;&lt;/script&gt;</code>
              </div>
            </div>
          </div>
          <div id="embedMsg" class="muted small"></div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        <div class="muted">(c) RealEstateAI</div>
      </div>
    </footer>

    <script src="/static/app.js" defer></script>
  </body>
</html>
